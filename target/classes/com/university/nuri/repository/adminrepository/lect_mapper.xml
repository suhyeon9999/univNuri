<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper  namespace="lecture">
  <!-- 강의리스트 불러오기 -->
  	<select id="getAllLectList" resultType="map">
  		select l.* , d.dept_name, c.*, u.name 
  		from lecture l
  		left join department d on l.dept_idx = d.dept_idx  
  		left join class c on l.class_idx = c.class_idx  
  		left join teacher t on l.t_idx = t.t_idx  
  		left join user u on t.user_idx = u.user_idx   		  		
  		where l.lect_active = 0    		  		
  	</select>
	<!-- 과목 과목군 리스트 -->
	<select id="lestSubSetList" parameterType="String" resultType="map">
		select j.subject_name, s.sub_set_name
  		from lecture_subject_set g
  		left join lecture l on g.lect_idx = l.lect_idx  
  		left join subject_set s on g.sub_set_idx = s.sub_set_idx  
  		left join subject j on s.subject_idx = j.subject_idx  	
  		where l.lect_idx=#{lect_idx}  and l.lect_active = 0
	</select>
	<!-- 학과 상세보기 -->
	<select id="detailLect" parameterType="String" resultType="map">
		select l.* , d.dept_name, c.*, u.name 
  		from lecture l
  		left join department d on l.dept_idx = d.dept_idx  
  		left join class c on l.class_idx = c.class_idx  
  		left join teacher t on l.t_idx = t.t_idx  
  		left join user u on t.user_idx = u.user_idx 
  		where l.lect_idx=#{lect_idx}
	</select>
	<!-- 정보 미입력 강의보기 -->	
  	<select id="searchNullLect" resultType="map">
  		select l.* , d.dept_name, c.*, u.name 
  		from lecture l
  		left join department d on l.dept_idx = d.dept_idx  
  		left join class c on l.class_idx = c.class_idx  
  		left join teacher t on l.t_idx = t.t_idx  
  		left join user u on t.user_idx = u.user_idx    
  		where ( t.t_idx is null or	t.lect_day is null or t.lect_start_time is null 
  		or t.lect_end_time is null  or t.class_idx is null   )
  		and l.lect_active = 0		
  	</select>
	<!-- 학과 검색 -->
	<!-- 강의코드로 검색 -->
	<select id="searchLectId" parameterType="String"  resultType="map">
  		select l.* , d.dept_name, c.*, u.name 
  		from lecture l
  		left join department d on l.dept_idx = d.dept_idx  
  		left join class c on l.class_idx = c.class_idx  
  		left join teacher t on l.t_idx = t.t_idx  
  		left join user u on t.user_idx = u.user_idx 
  		where l.lect_id like CONCAT('%', #{lect_id}, '%')  and l.lect_active = 0    		  		
  	</select>
	<!-- 강의명으로 검색 -->
	<select id="searchLectName" parameterType="String"  resultType="map">
  		select l.* , d.dept_name, c.*, u.name 
  		from lecture l
  		left join department d on l.dept_idx = d.dept_idx  
  		left join class c on l.class_idx = c.class_idx  
  		left join teacher t on l.t_idx = t.t_idx  
  		left join user u on t.user_idx = u.user_idx 
  		where l.lect_name like CONCAT('%', #{lect_name}, '%')  and l.lect_active = 0      		  		
  	</select>
	<!-- 개설학과로 검색 -->
	<select id="searchDeptName" parameterType="String"  resultType="map">
  		select l.* , d.dept_name, c.*, u.name 
  		from lecture l
  		left join department d on l.dept_idx = d.dept_idx  
  		left join class c on l.class_idx = c.class_idx  
  		left join teacher t on l.t_idx = t.t_idx  
  		left join user u on t.user_idx = u.user_idx 
  		where l.dept_name like CONCAT('%', #{dept_name}, '%') and l.lect_active = 0   	  		
  	</select>
	<!-- 강의요일로 검색 -->
	<select id="searchLectDay" parameterType="String"  resultType="map">
  		select l.* , d.dept_name, c.*, u.name 
  		from lecture l
  		left join department d on l.dept_idx = d.dept_idx  
  		left join class c on l.class_idx = c.class_idx  
  		left join teacher t on l.t_idx = t.t_idx  
  		left join user u on t.user_idx = u.user_idx 
  		where l.lect_day like CONCAT('%', #{lect_day}, '%') and l.lect_active = 0      		  		
  	</select>
	<!-- 담당교수로 검색 -->
	<select id="searchName" parameterType="String"  resultType="map">
  		select l.* , d.dept_name, c.*, u.name 
  		from lecture l
  		left join department d on l.dept_idx = d.dept_idx  
  		left join class c on l.class_idx = c.class_idx  
  		left join teacher t on l.t_idx = t.t_idx  
  		left join user u on t.user_idx = u.user_idx 
  		where u.name like CONCAT('%', #{name}, '%')  and l.lect_active = 0     		  		
  	</select>
	
  </mapper>